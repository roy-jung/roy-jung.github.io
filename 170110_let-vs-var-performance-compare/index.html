<!DOCTYPE html><html lang="ko-KR"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>let과 var의 성능 비교 | FE재남</title><link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/highlights/dracula.css"><link rel="canonical" href="http://roy-jung.github.io/170110_let-vs-var-performance-compare/"/>
<meta name="description" content="if, for 등의 block statement 외부에서 let으로 선언한 변수를 statement 내부에서 호출할 때에는 비용이 발생하기 때문에, 블록스코프의 영향을 받지 않는 var로 선언한 변수를 호출할 때보다 느리므로, 일반적으로 var를…">
<meta property="og:type" content="article">
<meta property="og:title" content="let과 var의 성능 비교">
<meta property="og:url" content="http://roy-jung.github.io/170110_let-vs-var-performance-compare/">
<meta property="og:site_name" content="FE재남">
<meta property="og:description" content="if, for 등의 block statement 외부에서 let으로 선언한 변수를 statement 내부에서 호출할 때에는 비용이 발생하기 때문에, 블록스코프의 영향을 받지 않는 var로 선언한 변수를 호출할 때보다 느리므로, 일반적으로 var를…">
<meta property="og:locale" content="ko_KR">
<meta property="og:image" content="http://roy-jung.github.io/images/category-es.png">
<meta property="article:published_time" content="2017-01-10T09:26:03.000Z">
<meta property="article:modified_time" content="2025-04-02T11:37:01.496Z">
<meta property="article:author" content="Jaenam Jung">
<meta property="article:tag" content="ecmascript">
<meta property="article:tag" content="javascript">
<meta property="article:tag" content="es6">
<meta property="article:tag" content="es2015">
<meta property="article:tag" content="let">
<meta property="article:tag" content="var">
<meta property="article:tag" content="scope">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://roy-jung.github.io/images/category-es.png"><meta property="article:author" content="Jaenam Jung"><meta property="twitter:label1" content="Published at"><meta property="twitter:data1" content="2017-01-10 18:26:03"><meta property="twitter:label2" content="Written by"><meta property="twitter:data2" content="Jaenam Jung"><link rel="icon" href="/images/logo.png"><link rel="alternate" href="/atom.xml" type="application/atom+xml" title="FE재남"><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="https://schema.org/WebPage"><nav class="menu" id="menu"><div class="menu-inner"><div class="menu__left-area"><div class="menu__item"><a class="menu__item__link menu__item__link--brand" href="/" title="Home" rel="home"><img class="menu__item__link--brand__image" src="/images/logo.png" alt="FE재남"><span class="menu__item__link--brand__label">FE재남</span></a></div></div><div class="menu__right-area"><div class="menu__item"><a class="menu__item__link" href="/">Home</a></div><div class="menu__item"><a class="menu__item__link" href="/about">About</a></div></div></div></nav><div class="page-background"></div><div class="content-container"><div class="content-outer"><div class="content-inner" itemscope itemtype="https://schema.org/Blog"><article class="article" id="article" itemscope itemtype="https://schema.org/BlogPosting"><h1 class="article__title" itemprop="headline">let과 var의 성능 비교</h1><div class="article__meta"><time class="article__meta__time" datetime="2017-01-10T09:26:03.000Z" itemprop="datePublished">2017-01-10 18:26:03</time><div class="article__meta__categories"><a class="article__meta__categories__item" href="/categories/ecmascript/">ECMAScript</a></div></div><div class="article__contents"><img src="/images/category-es.png"/><blockquote>
<p><code>if</code>, <code>for</code> 등의 block statement 외부에서 <code>let</code>으로 선언한 변수를 statement 내부에서 호출할 때에는 비용이 발생하기 때문에, 블록스코프의 영향을 받지 않는 <code>var</code>로 선언한 변수를 호출할 때보다 느리므로, 일반적으로 <code>var</code>를 쓰는 편이 낫다.</p>
</blockquote>
<p>라는 논지의 글을 읽었다. 정말로 그러한지 궁금하여 ES6의 <code>let</code>과 기존의 <code>var</code>의 성능 차이를 비교실험 해보면서 그 내용을 정리하여 포스팅한다.</p>
<!-- more  -->

<p>모든 테스트는 MacOS 10.11.6 에서 진행하였고, 테스트한 브라우저의 버전은 각 Chrome 55.0.2283.95, Firefox 50.1.0, Safari 10.0.2 이다.</p>
<h2 id="테스팅-방식"><a href="#테스팅-방식" class="headerlink" title="테스팅 방식"></a>테스팅 방식</h2><p>가급적 단순한 소스로 빠르게 테스트를 하기 위해, 테스팅 방법은 다음 함수를 이용하였다. 모든 테스트는 세 번씩 독립시행하였다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">timeCheck</span> = (<span class="params">times, test</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> res = <span class="number">0</span>,</span><br><span class="line">    t1,</span><br><span class="line">    t2</span><br><span class="line">  <span class="keyword">while</span> (times-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    t1 = <span class="variable language_">window</span>.<span class="property">performance</span>.<span class="title function_">now</span>()</span><br><span class="line">    <span class="title function_">test</span>()</span><br><span class="line">    t2 = <span class="variable language_">window</span>.<span class="property">performance</span>.<span class="title function_">now</span>()</span><br><span class="line">    res += t1 - t2</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(test.<span class="property">name</span>, res / times)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">compare</span> = (<span class="params">times, ...tests</span>) =&gt; &#123;</span><br><span class="line">  tests.<span class="title function_">forEach</span>(<span class="function"><span class="params">test</span> =&gt;</span> <span class="title function_">timeCheck</span>(times, test))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="for문-내부에서-변수-선언"><a href="#for문-내부에서-변수-선언" class="headerlink" title="for문 내부에서 변수 선언"></a>for문 내부에서 변수 선언</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> testVar = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;= <span class="number">10000</span>; i++) &#123; i * <span class="number">10</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">testLet</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;= <span class="number">10000</span>; i++) &#123; i * <span class="number">10</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">compare</span>(<span class="number">100000</span>, testVar, testLet);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 결과 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Chrome</span></span><br><span class="line">testVar <span class="number">504.3849999997001</span></span><br><span class="line">testLet <span class="number">1814.029999999897</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">515.3349999994971</span></span><br><span class="line">testLet <span class="number">2168.7300000004616</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">512.150000000518</span></span><br><span class="line">testLet <span class="number">2162.0000000004075</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Firefox</span></span><br><span class="line">testVar <span class="number">377.39500000001044</span></span><br><span class="line">testLet <span class="number">392.5850000000137</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">369.3049999999894</span></span><br><span class="line">testLet <span class="number">362.095000000103</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">369.91000000006534</span></span><br><span class="line">testLet <span class="number">360.53500000012355</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Safari</span></span><br><span class="line">testVar <span class="number">660.6800000000158</span></span><br><span class="line">testLet <span class="number">7921.925000000066</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">636.9849999999497</span></span><br><span class="line">testLet <span class="number">8070.989999999889</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">659.1450000000623</span></span><br><span class="line">testLet <span class="number">8052.3949999999895</span></span><br></pre></td></tr></table></figure>

<ul>
<li>크롬 : 3~4배 정도의 성능차이가 보인다. var는 블록스코프에 제한되지 않으며 재선언시 기존 변수를 그대로 활용하는 반면, let은 for문의 블록스코프에 의해 iterating 과정에서 매 번 새로 선언되므로, 이러한 차이는 당연한 결과인 듯 하다.</li>
<li>파이어폭스 : 둘 사이에 차이가 없다. 블록스코프에 대한 성능최적화가 잘 이뤄진 것 같다.</li>
<li>사파리 : let의 성능 저하가 심각하다;;</li>
</ul>
<h2 id="for문-외부에서-변수-선언"><a href="#for문-외부에서-변수-선언" class="headerlink" title="for문 외부에서 변수 선언"></a>for문 외부에서 변수 선언</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> testVar = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> i = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span>( ; i &lt;= <span class="number">10000</span>; i++) &#123; i * <span class="number">10</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">testLet</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span>( ; i &lt;= <span class="number">10000</span>; i++) &#123; i * <span class="number">10</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">compare</span>(<span class="number">100000</span>, testVar, testLet);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 결과 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Chrome</span></span><br><span class="line">testVar <span class="number">567.7750000001979</span></span><br><span class="line">testLet <span class="number">562.8849999998911</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">552.2350000001934</span></span><br><span class="line">testLet <span class="number">556.7149999999783</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">580.739999999023</span></span><br><span class="line">testLet <span class="number">558.8600000011284</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Firefox</span></span><br><span class="line">testVar <span class="number">368.3499999999258</span></span><br><span class="line">testLet <span class="number">361.55000000003383</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">385.23500000002605</span></span><br><span class="line">testLet <span class="number">391.53000000022075</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">385.8400000003203</span></span><br><span class="line">testLet <span class="number">386.88999999985754</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Safari</span></span><br><span class="line">testVar <span class="number">671.9050000000643</span></span><br><span class="line">testLet <span class="number">680.2949999999109</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">649.0050000001429</span></span><br><span class="line">testLet <span class="number">677.1050000001269</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">644.2449999999953</span></span><br><span class="line">testLet <span class="number">678.655000000108</span></span><br></pre></td></tr></table></figure>

<p>세 브라우저 모두 엎치락 뒤치락 한다. 유의미한 차이가 있다고 보기는 힘들다.<br>그러나 이론상 이 테스트는 동등한 조건의 비교가 아니다. let의 경우 for문 내부의 블록스코프로 인해 내부에서는 스코프 외부의 변수를 호출하는 것이기 때문이다.</p>
<h2 id="var와-let의-혼용-비교"><a href="#var와-let의-혼용-비교" class="headerlink" title="var와 let의 혼용 비교"></a>var와 let의 혼용 비교</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> testVar = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> i = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>( ; i &lt;= <span class="number">10000</span>; i++) &#123; sum += i; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testLet = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>( ; i &lt;= <span class="number">10000</span>; i++) &#123; sum += i; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testVarAndLet1 = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>( ; i &lt;= <span class="number">10000</span>; i++) &#123; sum += i; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testVarAndLet2 = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>( ; i &lt;= <span class="number">10000</span>; i++) &#123; sum += i; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">compare</span>(<span class="number">100000</span>, testVar, testLet, testVarAndLet1, testVarAndLet2);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 결과 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Chrome</span></span><br><span class="line">testVar <span class="number">328.94750000005934</span></span><br><span class="line">testLet <span class="number">1971.6525000000265</span></span><br><span class="line">testVarAndLet1 <span class="number">329.54000000009637</span></span><br><span class="line">testVarAndLet2 <span class="number">1987.0774999999967</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">329.9424999997682</span></span><br><span class="line">testLet <span class="number">1938.6849999998158</span></span><br><span class="line">testVarAndLet1 <span class="number">337.06249999996726</span></span><br><span class="line">testVarAndLet2 <span class="number">1977.209999999879</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">332.9599999998718</span></span><br><span class="line">testLet <span class="number">1969.6900000002897</span></span><br><span class="line">testVarAndLet1 <span class="number">335.554999999782</span></span><br><span class="line">testVarAndLet2 <span class="number">1982.3450000001758</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Firefox</span></span><br><span class="line">testVar <span class="number">564.0900000000029</span></span><br><span class="line">testLet <span class="number">562.0799999999808</span></span><br><span class="line">testVarAndLet1 <span class="number">584.0799999999813</span></span><br><span class="line">testVarAndLet2 <span class="number">568.134999999998</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">554.6249999998327</span></span><br><span class="line">testLet <span class="number">575.6050000002069</span></span><br><span class="line">testVarAndLet1 <span class="number">564.4250000000866</span></span><br><span class="line">testVarAndLet2 <span class="number">576.765000000104</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">551.2000000002226</span></span><br><span class="line">testLet <span class="number">591.664999999859</span></span><br><span class="line">testVarAndLet1 <span class="number">592.3350000000064</span></span><br><span class="line">testVarAndLet2 <span class="number">575.719999999892</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Safari</span></span><br><span class="line">testVar <span class="number">1216.0200000000077</span></span><br><span class="line">testLet <span class="number">1213.5549999999967</span></span><br><span class="line">testVarAndLet1 <span class="number">2708.7750000000124</span></span><br><span class="line">testVarAndLet2 <span class="number">2705.750000000038</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">1196.7449999999117</span></span><br><span class="line">testLet <span class="number">1210.9099999998725</span></span><br><span class="line">testVarAndLet1 <span class="number">2687.62000000017</span></span><br><span class="line">testVarAndLet2 <span class="number">2707.380000000063</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">1201.1799999999712</span></span><br><span class="line">testLet <span class="number">1236.5599999998667</span></span><br><span class="line">testVarAndLet1 <span class="number">2702.5649999999005</span></span><br><span class="line">testVarAndLet2 <span class="number">2728.939999999857</span></span><br></pre></td></tr></table></figure>

<ul>
<li>크롬 : 흥미로운 결과이지만, 스코프에 따른 비용을 생각하면 당연한 결과일 수도 있겠다. for문 외부에서 let으로 선언한 <code>sum</code>에 for문 내부에서 접근하기 위해서는 블록스코프 체이닝을 한 단계 거쳐야 하기 때문에 비용이 발생한다는 것이다. 아마도 원글에서는 이 부분을 말하고자 했던 것 같다.</li>
<li>파이어폭스 : 네 가지 테스트에 대해 아무런 차이가 없다. 파이어폭스만 놓고 보자면 블록스코프 체이닝으로 인한 성능저하는 고려할 필요가 없을 것 같다.</li>
<li>사파리 : 특이하게 <code>var</code>만 사용한 경우나 <code>let</code>만 사용한 경우엔 성능이 비슷한 반면, 혼용하면 느려진다. ES6전용엔진, ES5전용엔진, ES5 + ES6 엔진이 각각 마련되어 있으며, 혼용엔진의 성능이 좀 떨어지는 것이 아닐까 추측된다.</li>
</ul>
<h2 id="그렇다면-내장-메소드를-활용한다면-어떨까"><a href="#그렇다면-내장-메소드를-활용한다면-어떨까" class="headerlink" title="그렇다면 내장 메소드를 활용한다면 어떨까?"></a>그렇다면 내장 메소드를 활용한다면 어떨까?</h2><p>for문을 forEach로 대체한 경우와 reduce를 이용한 직접계산 방식을 테스트해보자.</p>
<h3 id="1-forEach로-전환"><a href="#1-forEach로-전환" class="headerlink" title="1. forEach로 전환"></a>1. forEach로 전환</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> testVar = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">forEach</span>(<span class="function">(<span class="params">v, i</span>) =&gt;</span> &#123; sum += i; &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testLet = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">forEach</span>(<span class="function">(<span class="params">v, i</span>) =&gt;</span> &#123; sum += i; &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">compare</span>(<span class="number">10000</span>, testVar, testLet);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 결과 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Chrome</span></span><br><span class="line">testVar <span class="number">916.9325000000117</span></span><br><span class="line">testLet <span class="number">1261.5850000000355</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">918.6650000000309</span></span><br><span class="line">testLet <span class="number">1298.54500000001</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">884.2624999999607</span></span><br><span class="line">testLet <span class="number">1285.3525000000227</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Firefox</span></span><br><span class="line">testVar <span class="number">874.3749999999818</span></span><br><span class="line">testLet <span class="number">828.920000000031</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">800.085000000101</span></span><br><span class="line">testLet <span class="number">812.5499999999629</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">814.4299999999675</span></span><br><span class="line">testLet <span class="number">796.349999999984</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Safari</span></span><br><span class="line">testVar <span class="number">3708.769999999984</span></span><br><span class="line">testLet <span class="number">3811.210000000001</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">3771.770000000024</span></span><br><span class="line">testLet <span class="number">3784.889999999963</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">3831.679999999993</span></span><br><span class="line">testLet <span class="number">3850.014999999996</span></span><br></pre></td></tr></table></figure>

<p>for문으로 돌린 것보다 느려지는 것은 당연하다.</p>
<ul>
<li>크롬 : var가 살짝 빠르다. forEach로 같은 연산을 수행하기 위해서는 외부 스코프의 변수 <code>sum</code>을 갱신하여야 하는데, 이런 경우에는 <code>let</code>이 <code>var</code>보다 더 큰 비용을 필요로 하는 것으로 보인다.</li>
<li>Firefox : 동일한 성능을 보인다. 결국 브라우저의 최적화 정도에 따라 다른 결론이 나온다고 볼 수밖에 없겠다.</li>
<li>사파리 : 테스트를 그만두고 싶다. 이걸 왜 하고 있는거지…? 앞으로는 사파리 테스트는 한 번만 진행하겠다.</li>
</ul>
<h3 id="2-reduce로-직접-계산"><a href="#2-reduce로-직접-계산" class="headerlink" title="2. reduce로 직접 계산"></a>2. reduce로 직접 계산</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> testVar = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">reduce</span>(<span class="function">(<span class="params">a, b, i</span>) =&gt;</span> a + i, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testLet = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">reduce</span>(<span class="function">(<span class="params">a, b, i</span>) =&gt;</span> a + i, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">compare</span>(<span class="number">10000</span>, testVar, testLet);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 결과 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Chrome</span></span><br><span class="line">testVar <span class="number">904.6750000000009</span></span><br><span class="line">testLet <span class="number">915.0900000000024</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">903.6025000000136</span></span><br><span class="line">testLet <span class="number">892.7199999999839</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">891.3525000000091</span></span><br><span class="line">testLet <span class="number">882.7275000000318</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Firefox</span></span><br><span class="line">testVar <span class="number">710.5149999999967</span></span><br><span class="line">testLet <span class="number">737.0249999999924</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">708.6700000000383</span></span><br><span class="line">testLet <span class="number">744.3350000000064</span></span><br><span class="line"></span><br><span class="line">testVar <span class="number">710.0099999999929</span></span><br><span class="line">testLet <span class="number">730.4449999999615</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Safari</span></span><br><span class="line">testVar <span class="number">4057.314999999999</span></span><br><span class="line">testLet <span class="number">4090.555000000005</span></span><br></pre></td></tr></table></figure>

<p>한편 reduce를 이용하면 메소드 내부에서 외부 스코프의 변수를 호출할 일이 없으므로 상대적으로 매우 양호한 성능을 보이며, <code>let</code>과 <code>var</code> 사이의 차이는 없는 것으로 확인된다.<br>이러한 차이에 대해 보다 자세히 확인하기 전에, 변인을 통제하기 위해 스코프 자체의 생성 비용을 먼저 확인해볼 필요가 있을 것 같다.</p>
<h2 id="내부-스코프가-없는-경우-vs-즉시실행함수-vs-블록스코프"><a href="#내부-스코프가-없는-경우-vs-즉시실행함수-vs-블록스코프" class="headerlink" title="내부 스코프가 없는 경우 vs. 즉시실행함수 vs. 블록스코프"></a>내부 스코프가 없는 경우 vs. 즉시실행함수 vs. 블록스코프</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> testNoScopeVar = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1000</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testNoScopeLet = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1000</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> testFunctionScope = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1000</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  &#125;)();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testBlockScope = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">let</span> sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1000</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">compare</span>(<span class="number">100000</span>, testNoScopeVar, testNoScopeLet, testFunctionScope, testBlockScope);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 결과 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Chrome</span></span><br><span class="line">testNoScopeVar <span class="number">1601.9000000000224</span></span><br><span class="line">testNoScopeLet <span class="number">1586.9125000000586</span></span><br><span class="line">testFunctionScope <span class="number">1588.4724999999517</span></span><br><span class="line">testBlockScope <span class="number">1582.192499999961</span></span><br><span class="line"></span><br><span class="line">testNoScopeVar <span class="number">1594.0849999999155</span></span><br><span class="line">testNoScopeLet <span class="number">1593.0999999999785</span></span><br><span class="line">testFunctionScope <span class="number">1706.752500000075</span></span><br><span class="line">testBlockScope <span class="number">1641.9625000000942</span></span><br><span class="line"></span><br><span class="line">testNoScopeVar <span class="number">1670.175000000112</span></span><br><span class="line">testNoScopeLet <span class="number">1708.109999999855</span></span><br><span class="line">testFunctionScope <span class="number">1678.099999999955</span></span><br><span class="line">testBlockScope <span class="number">1670.0550000006842</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Firefox</span></span><br><span class="line">testNoScopeVar <span class="number">2152.220000000035</span></span><br><span class="line">testNoScopeLet <span class="number">2145.2300000000196</span></span><br><span class="line">testFunctionScope <span class="number">2198.4799999999686</span></span><br><span class="line">testBlockScope <span class="number">2163.9349999999777</span></span><br><span class="line"></span><br><span class="line">testNoScopeVar <span class="number">2211.5000000000255</span></span><br><span class="line">testNoScopeLet <span class="number">2295.075000000037</span></span><br><span class="line">testFunctionScope <span class="number">2262.6200000000536</span></span><br><span class="line">testBlockScope <span class="number">2184.70499999994</span></span><br><span class="line"></span><br><span class="line">testNoScopeVar <span class="number">2263.599999999693</span></span><br><span class="line">testNoScopeLet <span class="number">2202.645000000368</span></span><br><span class="line">testFunctionScope <span class="number">2303.4850000000224</span></span><br><span class="line">testBlockScope <span class="number">2238.1649999999863</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Safari</span></span><br><span class="line">testNoScopeVar <span class="number">1201.3650000000011</span></span><br><span class="line">testNoScopeLet <span class="number">1180.3599999999997</span></span><br><span class="line">testFunctionScope <span class="number">1215.030000000006</span></span><br><span class="line">testBlockScope <span class="number">1207.0399999999972</span></span><br><span class="line"></span><br><span class="line">testNoScopeVar <span class="number">1201.0800000000418</span></span><br><span class="line">testNoScopeLet <span class="number">1217.4399999999187</span></span><br><span class="line">testFunctionScope <span class="number">1215.8149999999368</span></span><br><span class="line">testBlockScope <span class="number">1200.325000000099</span></span><br><span class="line"></span><br><span class="line">testNoScopeVar <span class="number">1202.5349999998944</span></span><br><span class="line">testNoScopeLet <span class="number">1195.4449999999779</span></span><br><span class="line">testFunctionScope <span class="number">1192.2499999997235</span></span><br><span class="line">testBlockScope <span class="number">1196.464999999982</span></span><br></pre></td></tr></table></figure>

<p>기존까지의 테스트와 달리 이번 테스트는 파이어폭스가 가장 느리게 나왔으며, 사파리의 약진이 돋보여 한 번만 하겠다는 다짐을 깨고 세 번 돌려보았다.<br>놀랍게도 세 브라우저 모두 스코프 생성 자체는 성능상에 거의 아무런 영향을 주지 않는 것으로 확인된다. 혹시 스코프를 한 번만 생성했기 때문에 영향이 없었던 것은 아닐까? 스코프를 잔뜩 생성해서 테스트 해보자.</p>
<h2 id="스코프를-1000회-생성"><a href="#스코프를-1000회-생성" class="headerlink" title="스코프를 1000회 생성"></a>스코프를 1000회 생성</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> testFunctionScope = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1000</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">_</span>=&gt;</span> &#123;</span><br><span class="line">    (<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="keyword">var</span> sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1000</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125;)();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testBlockScope = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1000</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">_</span>=&gt;</span> &#123;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">let</span> sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1000</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">compare</span>(<span class="number">1000</span>, testFunctionScope, testBlockScope);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 결과 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Chrome</span></span><br><span class="line">testFunctionScope <span class="number">16264.852499999985</span></span><br><span class="line">testBlockScope <span class="number">15813.532500000016</span></span><br><span class="line"></span><br><span class="line">testFunctionScope <span class="number">16406.502499999522</span></span><br><span class="line">testBlockScope <span class="number">16261.40749999987</span></span><br><span class="line"></span><br><span class="line">testFunctionScope <span class="number">16506.43499999994</span></span><br><span class="line">testBlockScope <span class="number">16097.730000000083</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Firefox</span></span><br><span class="line">testFunctionScope <span class="number">21992.190000000028</span></span><br><span class="line">testBlockScope <span class="number">21433.97000000001</span></span><br><span class="line"></span><br><span class="line">testFunctionScope <span class="number">21121.65000000008</span></span><br><span class="line">testBlockScope <span class="number">21132.1000000005</span></span><br><span class="line"></span><br><span class="line">testFunctionScope <span class="number">22201.30000000063</span></span><br><span class="line">testBlockScope <span class="number">21140.65000000017</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Safari</span></span><br><span class="line">testFunctionScope <span class="number">11941.540000000026</span></span><br><span class="line">testBlockScope <span class="number">11820.930000000008</span></span><br><span class="line"></span><br><span class="line">testFunctionScope <span class="number">12206.484999999979</span></span><br><span class="line">testBlockScope <span class="number">12454.840000000018</span></span><br><span class="line"></span><br><span class="line">testFunctionScope <span class="number">12273.975000000224</span></span><br><span class="line">testBlockScope <span class="number">12344.614999999932</span></span><br></pre></td></tr></table></figure>

<p>이정도면 블록스코프와 즉시실행함수의 속도차이는 없다고 보아야 할 것이다. 그렇다면 이제 <code>let</code>과 <code>var</code>가 외부 스코프의 변수를 갱신하는 데에 드는 비용을 확인해볼 수 있겠다. Safari에 대해 안좋게 평가했던 내 자신을 반성한다.</p>
<h2 id="외부스코프에-대한-비용-비교-1"><a href="#외부스코프에-대한-비용-비교-1" class="headerlink" title="외부스코프에 대한 비용 비교 - 1"></a>외부스코프에 대한 비용 비교 - 1</h2><p>반복을 위한 함수선언 자체가 새로운 스코프를 만들게 되므로, 이런 변인을 통제(새로운 스코프 형성 없이 테스트)하기 위해 무식한 소스를 작성해보았다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> testFunctionScopeVar = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params"></span>)&#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;)();</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params"></span>)&#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;)();</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params"></span>)&#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;)();</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params"></span>)&#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;)();</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params"></span>)&#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;)();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testFunctionScopeLet = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params"></span>)&#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;)();</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params"></span>)&#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;)();</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params"></span>)&#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;)();</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params"></span>)&#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;)();</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params"></span>)&#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;)()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> testBlockScopeVar = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  &#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  &#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  &#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  &#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  &#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testBlockScopeLet = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  &#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  &#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  &#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  &#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;</span><br><span class="line">  sum = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">  &#123; sum = sum.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">compare</span>(<span class="number">1000</span>, testFunctionScopeVar, testFunctionScopeLet, testBlockScopeVar, testBlockScopeLet);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 결과 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Chrome</span></span><br><span class="line">testFunctionScopeVar <span class="number">798.4200000000856</span></span><br><span class="line">testFunctionScopeLet <span class="number">781.6874999999345</span></span><br><span class="line">testBlockScopeVar <span class="number">786.3724999999904</span></span><br><span class="line">testBlockScopeLet <span class="number">779.984999999986</span></span><br><span class="line"></span><br><span class="line">testFunctionScopeVar <span class="number">798.8450000002049</span></span><br><span class="line">testFunctionScopeLet <span class="number">850.8949999999168</span></span><br><span class="line">testBlockScopeVar <span class="number">860.9525000000867</span></span><br><span class="line">testBlockScopeLet <span class="number">822.717499999897</span></span><br><span class="line"></span><br><span class="line">testFunctionScopeVar <span class="number">829.2199999999721</span></span><br><span class="line">testFunctionScopeLet <span class="number">821.3075000001991</span></span><br><span class="line">testBlockScopeVar <span class="number">856.947499999922</span></span><br><span class="line">testBlockScopeLet <span class="number">799.0949999999866</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Firefox</span></span><br><span class="line">testFunctionScopeVar <span class="number">939.735000000006</span></span><br><span class="line">testFunctionScopeLet <span class="number">13033.770000000011</span></span><br><span class="line">testBlockScopeVar <span class="number">13230.579999999976</span></span><br><span class="line">testBlockScopeLet <span class="number">13146.650000000001</span></span><br><span class="line"></span><br><span class="line">testFunctionScopeVar <span class="number">13114.275000000023</span></span><br><span class="line">testFunctionScopeLet <span class="number">13361.729999999778</span></span><br><span class="line">testBlockScopeVar <span class="number">3324.755000000092</span></span><br><span class="line">testBlockScopeLet <span class="number">13032.479999999865</span></span><br><span class="line"></span><br><span class="line">testFunctionScopeVar <span class="number">13281.810000000201</span></span><br><span class="line">testFunctionScopeLet <span class="number">13104.510000000242</span></span><br><span class="line">testBlockScopeVar <span class="number">13282.044999999867</span></span><br><span class="line">testBlockScopeLet <span class="number">13141.575000000244</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Safari</span></span><br><span class="line">testFunctionScopeVar <span class="number">631.1549999999843</span></span><br><span class="line">testFunctionScopeLet <span class="number">623.5099999999984</span></span><br><span class="line">testBlockScopeVar <span class="number">641.4000000000196</span></span><br><span class="line">testBlockScopeLet <span class="number">622</span></span><br><span class="line"></span><br><span class="line">testFunctionScopeVar <span class="number">661.0600000000013</span></span><br><span class="line">testFunctionScopeLet <span class="number">652.924999999992</span></span><br><span class="line">testBlockScopeVar <span class="number">630.9400000000023</span></span><br><span class="line">testBlockScopeLet <span class="number">644.5299999999916</span></span><br><span class="line"></span><br><span class="line">testFunctionScopeVar <span class="number">658.5400000000045</span></span><br><span class="line">testFunctionScopeLet <span class="number">652.0749999999971</span></span><br><span class="line">testBlockScopeVar <span class="number">645.9750000000058</span></span><br><span class="line">testBlockScopeLet <span class="number">644.9399999999987</span></span><br></pre></td></tr></table></figure>

<p>이상하다. 앞서 테스트에서는 분명 블록스코프를 형성하는 for문에서 외부스코프에 접근할 때에 비용 차이가 있었는데, 이번에는 그 차이가 전혀 보이지 않는다. for문을 가지고 다른 변인통제장치를 마련하여 다시 한 번 테스트 해보자. ( 파이어폭스가 잠깐 넋이 나간걸까… ? )</p>
<h2 id="외부스코프에-대한-비용-비교-2-for문"><a href="#외부스코프에-대한-비용-비교-2-for문" class="headerlink" title="외부스코프에 대한 비용 비교 - 2. for문"></a>외부스코프에 대한 비용 비교 - 2. for문</h2><p>for문은 자체적으로 블록스코프를 형성하므로, 블록스코프와 즉시실행함수의 성능 차이가 거의 없다는 전제하에 var에 대해서도 let과 마찬가지로 외부스코프의 변수에 접근하게끔 for문 내부에 즉시실행함수를 넣어보았다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> testVarNoScope = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt;= <span class="number">10000</span>; i++) &#123;</span><br><span class="line">    sum += i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testVar = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt;= <span class="number">10000</span>; i++) &#123;</span><br><span class="line">    (<span class="keyword">function</span>(<span class="params"></span>)&#123; sum += i; &#125;)();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testLet = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt;= <span class="number">10000</span>; i++) &#123;</span><br><span class="line">    sum += i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testLetWithFunctionScope = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt;= <span class="number">10000</span>; i++) &#123;</span><br><span class="line">    (<span class="keyword">function</span>(<span class="params"></span>)&#123; sum += i; &#125;)();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> testLetWithBlockScope = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt;= <span class="number">10000</span>; i++) &#123;</span><br><span class="line">    &#123; sum += i; &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">compare</span>(<span class="number">10000</span>, testVarNoScope, testVar, testLet, testLetWithFunctionScope, testLetWithBlockScope);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 결과 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Chrome</span></span><br><span class="line">testVarNoScope <span class="number">35.77249999992273</span></span><br><span class="line">testVar <span class="number">1163.234999999855</span></span><br><span class="line">testLet <span class="number">504.2325000000492</span></span><br><span class="line">testLetWithFunctionScope <span class="number">4295.67250000003</span></span><br><span class="line">testLetWithBlockScope <span class="number">500.6700000000783</span></span><br><span class="line"></span><br><span class="line">testVarNoScope <span class="number">36.612500000046566</span></span><br><span class="line">testVar <span class="number">1221.842499999766</span></span><br><span class="line">testLet <span class="number">518.9699999999648</span></span><br><span class="line">testLetWithFunctionScope <span class="number">4509.729999999974</span></span><br><span class="line">testLetWithBlockScope <span class="number">549.4775000002774</span></span><br><span class="line"></span><br><span class="line">testVarNoScope <span class="number">36.07249999981286</span></span><br><span class="line">testVar <span class="number">1247.2349999999278</span></span><br><span class="line">testLet <span class="number">518.7849999999453</span></span><br><span class="line">testLetWithFunctionScope <span class="number">4420.822500000126</span></span><br><span class="line">testLetWithBlockScope <span class="number">504.9025000000038</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Firefox</span></span><br><span class="line">testVarNoScope <span class="number">55.274999999963256</span></span><br><span class="line">testVar <span class="number">76.43499999997948</span></span><br><span class="line">testLet <span class="number">55.2449999999626</span></span><br><span class="line">testLetWithFunctionScope <span class="number">42008.84499999993</span></span><br><span class="line">testLetWithBlockScope <span class="number">52.959999999948195</span></span><br><span class="line"></span><br><span class="line">testVarNoScope <span class="number">55.64499999990221</span></span><br><span class="line">testVar <span class="number">222.23999999988882</span></span><br><span class="line">testLet <span class="number">51.19499999989057</span></span><br><span class="line">testLetWithFunctionScope <span class="number">40998.735000000204</span></span><br><span class="line">testLetWithBlockScope <span class="number">52.89000000010128</span></span><br><span class="line"></span><br><span class="line">testVarNoScope <span class="number">54.12999999962631</span></span><br><span class="line">testVar <span class="number">225.33499999943888</span></span><br><span class="line">testLet <span class="number">51.91500000018277</span></span><br><span class="line">testLetWithFunctionScope <span class="number">42197.229999999894</span></span><br><span class="line">testLetWithBlockScope <span class="number">52.25500000020838</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Safari</span></span><br><span class="line">testVarNoScope <span class="number">119.68999999999824</span></span><br><span class="line">testVar <span class="number">2372.4249999999956</span></span><br><span class="line">testLet <span class="number">837.6250000000036</span></span><br><span class="line">testLetWithFunctionScope <span class="number">3112.0200000000023</span></span><br><span class="line">testLetWithBlockScope <span class="number">847.4800000000105</span></span><br><span class="line"></span><br><span class="line">testVarNoScope <span class="number">112.06999999999607</span></span><br><span class="line">testVar <span class="number">2435.275000000034</span></span><br><span class="line">testLet <span class="number">832.6699999999837</span></span><br><span class="line">testLetWithFunctionScope <span class="number">3124.41</span></span><br><span class="line">testLetWithBlockScope <span class="number">843.8000000000211</span></span><br><span class="line"></span><br><span class="line">testVarNoScope <span class="number">116.38000000001557</span></span><br><span class="line">testVar <span class="number">2436.8349999999846</span></span><br><span class="line">testLet <span class="number">876.3200000000943</span></span><br><span class="line">testLetWithFunctionScope <span class="number">3205.7199999999684</span></span><br><span class="line">testLetWithBlockScope <span class="number">875.5450000000201</span></span><br></pre></td></tr></table></figure>

<ul>
<li>크롬 : 스코프가 전혀 중첩되지 않은 첫번째의 결과가 가장 뛰어나고, 그 다음으로는 블록스코프 하나(for문 자체)로 이루어진 세번째 및 블록스코프 둘(for문 자체 + 내부)로 이루어진 다섯번째 결과가 동일한 성능을 보이고 있다. 반면 즉시실행함수는 상당한 비용을 소모하는 것으로 확인된다. 네번째 결과가 훨씬 높게 나타난 이유는 두번째와 비교해 스코프 중첩이 한 번 더 있기 때문이 아닐까 추측된다.</li>
<li>파이어폭스 : 스코프가 없는 상태의 <code>var</code>(testVarNoScope)보다도 블록스코프가 있는 상태(for)의 <code>let</code>의 결과(testLet)가 더욱 좋은 성능을 발휘한다. 모든 면에서 ES5 이하의 기능으로 구현한 소스보다 ES6에서 추가된 기능들이 더욱 좋은 성능을 보인다.</li>
<li>사파리 : 크롬보다는 좀더 빠른 성능을 보이고 있는데, 결과 사이의 상대적 차이는 크롬과 비슷하다.</li>
</ul>
<p>이 테스트는 영 개운치 않다. 앞선 테스트에서는 블록스코프와 즉시실행함수 사이에 성능차이가 없었는데, for문 내부에서 호출한 즉시실행함수 만큼은 모든 브라우저에서 현저히 느리다.</p>
<h2 id="let이나-const-선언이-없다면-블록스코프가-생성되지-않는가"><a href="#let이나-const-선언이-없다면-블록스코프가-생성되지-않는가" class="headerlink" title="let이나 const 선언이 없다면 블록스코프가 생성되지 않는가?"></a><code>let</code>이나 <code>const</code> 선언이 없다면 블록스코프가 생성되지 않는가?</h2><p>tc39의 <a target="_blank" rel="noopener" href="http://www.ecma-international.org/ecma-262/6.0/#sec-lexical-environments">ECMAScript2015 Specfication - Lexical Environments</a>는 다음과 같이 기술하고 있다.</p>
<blockquote>
<p>A Lexical Environment is a specification type used to define the association of Identifiers to specific variables and functions based upon the lexical nesting structure of ECMAScript code. (중략) Usually a Lexical Environment is associated with some specific syntactic structure of ECMAScript code such as a FunctionDeclaration, a BlockStatement, or a Catch clause of a TryStatement and a new Lexical Environment is created each time such code is evaluated.</p>
<blockquote>
<p>(발번역 주의) 렉시컬 환경은 ECMAScript 코드의 렉시컬 중첩구조를 기반으로 식별자(identifier)와 특정 변수 및 함수와의 연관성을 정의하기 위한 스펙 유형이다. 렉시컬 환경은 일반적으로 <code>Function Declaration</code>, <code>Block Statement</code>, <code>try</code>구문의 <code>catch</code> 절과 같은 ECMAScript 코드의 특정 구문 구조와 연결되며, 이러한 코드가 평가될 때마다 새로운 렉시컬 환경이 생성된다.</p>
</blockquote>
</blockquote>
<p>즉 ‘block statement’가 평가될 때마다 새로운 렉시컬 환경이 생성되며, 이 때 블록스코프가 생성되는 것으로 보아야 할 것이다. let이나 const 선언 유무와 무관하게 블록스코프는 무조건 형성된다. 기존의 함수 내부에 <code>var</code> 변수를 선언하든 하지 않든 함수스코프가 생성되는 것에는 어떠한 영향도 주지 않는 것과 마찬가지로 말이다.</p>
<h2 id="요약-및-결론"><a href="#요약-및-결론" class="headerlink" title="요약 및 결론"></a>요약 및 결론</h2><ul>
<li><p>각 브라우저별로 상황에 따라 상대적으로 빠른 연산을 수행하기도 하고 반대로 매우 느리게 처리하기도 하는 등, 성능이 다 다르다. 테스트 결과 특별히 어느 브라우저가 제일 뛰어나다는 판단은 내릴 수 없겠다.</p>
</li>
<li><p>블록스코프와 즉시실행함수 자체의 비용 차이는 크지 않은 것으로 확인되었다.</p>
</li>
<li><p>다만 for문 내부에 즉시실행함수를 삽입할 경우에는 모든 브라우저에서 매우 느리게 동작한다.</p>
</li>
<li><p>스코프체이닝으로 외부 변수에 엑세스할 때의 비용 역시 <code>var</code>와 <code>let</code>이 큰 차이를 보이지 않는다. 다만 파이어폭스의 경우 let이 var보다도 조금 더 빠른 성능을 보이고, 사파리의 경우 둘을 함께 쓸 경우 배로 느려진다.</p>
</li>
<li><p><code>if</code>나 <code>for</code>처럼 그 자체가 블록스코프를 지니는 경우, 그 중에서도 block statement 외부의 변수를 내부에서 사용하는 경우에는, 크롬 및 사파리의 경우 <code>var</code>를 활용하는 편이 더 좋은 성능을 발휘하는 반면, 파이어폭스는 <code>let</code>을 그대로 사용하는 편이 더 낫다.</p>
</li>
<li><p>스코프 체이닝을 최소화하는 것이 좋다는 것은 당연한 상식이다. 그러나 이는 어디까지나 이론상 그렇다는 것이고, 테스트 결과 엔진 내부 로직에 따라(어떻게 구현되었는지는 모르겠지만 아무튼) 블록스코프가 성능에 거의 영향을 주지 않는 경우도 있는 것으로 확인된다(파이어폭스).</p>
</li>
<li><p><em>일반적인 경우 var 변수가 더 효율적</em> 인지 여부는 <strong>브라우저마다, 상황마다 다르다</strong>. 기존의 코딩스타일 안에서 새로운 문법시스템을 판단하는 것 자체가 잘못된 접근일 수 있다는 생각도 든다. 기왕 블록스코프가 도입된 이상 블록스코프 내에서 독립적으로 처리할 방안(<code>reduce</code> 등)을 고민하고, 마땅한 수단이 없는 경우에 한해 부득이 외부 변수를 호출하되, <code>var</code>를 쓸지 <code>let</code>을 쓸지는 타겟 브라우저에 따라 판단해야 할 것 같다.</p>
</li>
<li><p>불과 1년 전 <code>var와 let의 성능비교</code> 테스트에 대한 블로그 포스팅을 읽은 적이 있는데, 당시에는 <code>var</code>가 <code>let</code>보다 압도적으로 빠르게 연산을 수행했던 것으로 기억한다. 그 1년 사이 둘의 성능은 같아졌다. 그만큼 최적화가 이루어져왔었기 때문이다. 그렇다면 앞서 확인했던 외부스코프에 대한 접근 성능 역시 점차 최적화가 될 것이라 기대한다.</p>
</li>
<li><p>세 브라우저가 각각의 상황에서 저마다 다른 성능을 보여주었다. 즉 최적화가 얼마나 어떻게 진행되었는지에 따라 성능은 얼마든지 달라질 수 있는 문제이며, 현재의 결론이 1년 뒤에는 또 어떻게 달라질지도 모를 일이다.</p>
</li>
<li><p>개인적으로는 파이어폭스처럼 다른 브라우저들도 외부스코프에 대한 접근 성능이 충분히 최적화될 것이라 기대하면서 지금부터 그냥 <code>let</code>을 쓰겠다. 혼용하는 편이 더 헷갈림.</p>
</li>
</ul>
</div><div class="article__tags"><a class="article__tags__item" href="/tags/ecmascript/">ecmascript</a><a class="article__tags__item" href="/tags/javascript/">javascript</a><a class="article__tags__item" href="/tags/es6/">es6</a><a class="article__tags__item" href="/tags/es2015/">es2015</a><a class="article__tags__item" href="/tags/let/">let</a><a class="article__tags__item" href="/tags/var/">var</a><a class="article__tags__item" href="/tags/scope/">scope</a></div><div class="article__author" itemscope itemprop="author" itemtype="https://schema.org/Person"><img class="article__author__image" src="https://www.gravatar.com/avatar/02e9f56a3202da2e6e0e36a5a23facbb" alt="Jaenam Jung"><a class="article__author__link" title="About Jaenam Jung" rel="author">Jaenam Jung</a><p class="article__author__desc">할 수 있는걸 합니다.</p><div class="article__author__socials"><a class="article__author__socials__item" href="http://github.com/roy-jung" title="github" target="_blank"><i class="fa fa-github"></i></a><a class="article__author__socials__item" href="/atom.xml" title="rss" target="_blank"><i class="fa fa-rss"></i></a></div><meta itemprop="name" content="Jaenam Jung"></div><div class="sharer" id="sharer"><div class="sharer-inner"><div class="sharer__right"><button class="sharer__item" id="sharer-facebook"><i class="fa fa-facebook-official"></i></button><button class="sharer__item" id="sharer-twitter"><i class="fa fa-twitter"></i></button><button class="sharer__item" id="sharer-pinterest"><i class="fa fa-pinterest"></i></button><button class="sharer__item" id="sharer-pocket"><i class="fa fa-get-pocket"></i></button></div></div></div><!-- Disqus Code--><div id="disqus_thread"></div><script>(function() {
  var d = document, s = d.createElement('script');
  s.src = '//gomugom.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();</script><noscript>Enable JavaScript to see comments.</noscript><!-- Meta Tags for Structured Data--><meta itemprop="dateModified" content="2025-04-02T11:37:01.496Z"><meta itemprop="articleBody" content="
if, for 등의 block statement 외부에서 let으로 선언한 변수를 statement 내부에서 호출할 때에는 비용이 발생하기 때문에, 블록스코프의 영향을 받지 않는 var로 선언한 변수를 호출할 때보다 느리므로, 일반적으로 var를 쓰는 편이 낫다.

라는 논지의 글을 읽었다. 정말로 그러한지 궁금하여 ES6의 let과 기존의..."><meta itemprop="url" content="http://roy-jung.github.io/170110_let-vs-var-performance-compare/"><meta itemprop="mainEntityOfPage" content="http://roy-jung.github.io/170110_let-vs-var-performance-compare/"><div itemscope itemtype="https://schema.org/Organization" itemprop="publisher"><meta itemprop="name" content="FE재남"><div itemscope itemprop="logo" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="http://roy-jung.github.io/images/logo.png"></div></div><div itemscope itemtype="https://schema.org/ImageObject" itemprop="image"><meta itemprop="contentUrl" content="http://roy-jung.github.io/images/category-es.png"><meta itemprop="url" content="http://roy-jung.github.io/images/category-es.png"><meta itemprop="width" content="200"><meta itemprop="height" content="200"></div></article><section class="related-posts"><h3>Related posts</h3><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/161007_is-class-only-a-syntactic-sugar/"><div class="related-posts__item__background" style="background-image:url('/images/category-es.png');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">ES6 Class는 단지 prototype 상속의 문법설탕일 뿐인가?</span></a></div><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/161128_es6-for-react/"><div class="related-posts__item__background" style="background-image:url('/images/category-es.png');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">ReactJS를 작성할 때에 알아두면 좋은 ES6 문법들</span></a></div><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/161127_how-to-make-private-member/"><div class="related-posts__item__background" style="background-image:url('/images/category-es.png');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">ES6 Class에서 private member를 정의하는 방법</span></a></div></section></div></div></div><footer id="footer"><div class="widgets"><div class="widgets-inner"><!-- Jade doesn't support dynamic inclusion with `each`.--><!-- So, I just hard coded the file names that will be included.--><div class="widgets__item"><h3 class="widgets__item__heading">Recent posts</h3><ul class="recent-posts"><li class="recent-posts__item"><a href="/250701-history-of-js/">간략한 자바스크립트 역사</a></li><li class="recent-posts__item"><a href="/iterator-helper-overview/">이터레이터 헬퍼 맛보기</a></li><li class="recent-posts__item"><a href="/250414-react-reconciliation-deep-dive/">React Reconciliation: 컴포넌트 뒤에 숨겨진 엔진</a></li><li class="recent-posts__item"><a href="/250323-react-server-components/">리액트 서버 컴포넌트 톺아보기 (번역)</a></li><li class="recent-posts__item"><a href="/211231-review-2021/">2021 회고</a></li></ul></div><div class="widgets__item"><h3 class="widgets__item__heading">Archives</h3><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/07/">2025 7월</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/05/">2025 5월</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/04/">2025 4월</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">2022 1월</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">2020 11월</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">2020 10월</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">2017 1월</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">2016 12월</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">2016 11월</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">2016 10월</a><span class="archive-list-count">2</span></li></ul></div><div class="widgets__item"><h3 class="widgets__item__heading">Categories</h3><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ecmascript/">ECMAScript</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/fe/">FE</a><span class="category-list-count">11</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/fe/react-js/">React.js</a><span class="category-list-count">5</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/fe/react-js/next-js/">Next.js</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/fe/javascript/">javascript</a><span class="category-list-count">6</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/etc/">etc</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a><span class="category-list-count">1</span></li></ul></div></div></div><p class="copyright"><small>© 2025 Jaenam Jung<br>Powered by <a href="https://hexo.io" rel="external" target="_blank">Hexo</a>, Theme by <a href="https://github.com/hyunseob" rel="external" target="_blank">HyunSeob</a></small></p></footer><script src="/js/sharer.min.js"></script></body></html>